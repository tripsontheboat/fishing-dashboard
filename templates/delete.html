{% extends "base.html" %}
{% block content %}

<h1 style="text-align:center; color:#1a73e8;">Edit Observation</h1>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #eef3f8;
        margin: 0;
        padding: 0;
        color: #2c3e50;
    }

    .form-card {
        max-width: 550px;
        margin: 40px auto;
        background: white;
        padding: 30px;
        border-radius: 14px;
        box-shadow: 0 3px 12px rgba(0,0,0,0.12);
    }

    label {
        display: block;
        margin-top: 15px;
        font-weight: bold;
        color: #1a73e8;
    }

    .icon {
        margin-right: 6px;
    }

    input, textarea {
        width: 100%;
        padding: 12px;
        margin-top: 6px;
        border: 1px solid #cfd8e3;
        border-radius: 6px;
        background: #f8fbff;
    }

    textarea {
        height: 80px;
        resize: vertical;
    }

    .current-img {
        width: 220px;
        margin-top: 10px;
        border-radius: 10px;
        cursor: pointer;
        border: 2px solid #d0d7de;
    }

    .preview {
        width: 180px;
        margin-top: 10px;
        border-radius: 10px;
        display: none;
        border: 2px solid #1a73e8;
    }

    .placeholder {
        width: 180px;
        height: 130px;
        background: #d0d7de;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 40px;
        color: white;
        margin-top: 10px;
    }

    .lightbox {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.85);
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }

    .lightbox img {
        max-width: 90%;
        max-height: 90%;
        border-radius: 12px;
    }

    button {
        margin-top: 25px;
        width: 100%;
        padding: 14px;
        background: #1a73e8;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 17px;
        cursor: pointer;
        font-weight: bold;
    }

    button:hover {
        background: #155fc0;
    }
</style>

<script>
    function previewImage(event) {
        const file = event.target.files[0];
        const preview = document.getElementById("preview");
        const placeholder = document.getElementById("placeholder");

        if (file) {
            preview.src = URL.createObjectURL(file);
            preview.style.display = "block";
            placeholder.style.display = "none";
        }
    }

    function openLightbox(src) {
        document.getElementById("lightbox-img").src = src;
        document.getElementById("lightbox").style.display = "flex";
    }

    function closeLightbox() {
        document.getElementById("lightbox").style.display = "none";
    }
</script>

<div class="form-card">
    <h1>Edit Observation</h1>

    <form method="POST" enctype="multipart/form-data">

        <label><span class="icon">ğŸ“…</span>Date</label>
        <input type="date" name="date" value="{{ record['date'] }}" required>

        <label><span class="icon">ğŸ“</span>Location</label>
        <input type="text" name="location" value="{{ record['location'] }}" required>

        <label><span class="icon">ğŸŸ</span>Species</label>
        <input type="text" name="species" value="{{ record['species'] }}" required>

        <label><span class="icon">ğŸ”¢</span>Count</label>
        <input type="number" name="count" value="{{ record['count'] }}" required>

        <label><span class="icon">ğŸª±</span>Bait</label>
        <input type="text" name="bait" value="{{ record['bait'] }}">

        <label><span class="icon">ğŸ“</span>Size</label>
        <input type="text" name="size" value="{{ record['size'] }}">

        <label><span class="icon">ğŸŒŠ</span>Water</label>
        <input type="text" name="water" value="{{ record['water'] }}">

        <label><span class="icon">ğŸš¤</span>Platform</label>
        <input type="text" name="platform" value="{{ record['platform'] }}">

        <label><span class="icon">ğŸ“</span>Comments</label>
        <textarea name="comments">{{ record['comments'] }}</textarea>

        <label><span class="icon">ğŸ“¸</span>Current Photo</label>
        {% if record['image'] %}
            <img class="current-img"
                 src="/static/uploads/{{ record['image'] }}"
                 onclick="openLightbox('/static/uploads/{{ record['image'] }}')">
        {% else %}
            <div class="placeholder">ğŸ“·</div>
        {% endif %}

        <input type="hidden" name="existing_image" value="{{ record['image'] }}">

        <label><span class="icon">ğŸ“¤</span>Upload New Photo (optional)</label>
        <input type="file" name="image" onchange="previewImage(event)">

        <div id="placeholder" class="placeholder">ğŸ“·</div>
        <img id="preview" class="preview">

        <button type="submit">Save Changes</button>
    </form>
</div>

<!-- Lightbox -->
<div id="lightbox" class="lightbox" onclick="closeLightbox()">
    <img id="lightbox-img">
</div>

{% endblock %}

